---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# CytOpT.R

<<<<<<< HEAD
The goal of CytOpT.R is to ...
=======
<!-- badges: start -->
[![R-CMD-check](https://github.com/sistm/CytOpt-R/workflows/R-CMD-check/badge.svg)](https://github.com/sistm/CytOpt-R/actions)
<!-- badges: end -->

The goal of CytOpT.R is to regularized optimal transport to directly estimate the different cell population proportions from a biological sample characterized with flow cytometry measurements.
>>>>>>> 7890f016ef9bfa7b727c0b774002cf3e0a4ab9fa
>
> ## Overview

The **CytOpT** is new package includes a new algorithm using regularized optimal transport to directly estimate the different cell population proportions from a biological sample characterized with flow cytometry measurements. Algorithm is based on the regularized Wasserstein metric to compare cytometry measurements from different samples, thus accounting for possible mis-alignment of a given cell population across sample (due to technical variability from the technology of measurements).

The main function of the package is `CytOpT()`.

The methods implemented in this package are detailed in the following article:

> Paul Freulon, Jérémie Bigot, Boris P. Hejblum. CytOpT: Optimal Transport with Domain Adaptation for Interpreting Flow Cytometry data
> https://arxiv.org/abs/2006.09003

## Installation

You can install the development version of CytOpT like so:
```{r GitHub-install, eval=FALSE}
install.packages("CytOpT")
```


## Example

This is a basic example which shows you how to solve a common problem:

```{r example}
# Source Data
X_source <- read.csv('tests/ressources/W2_1_values.csv')
Lab_source <- read.csv('tests/ressources/W2_1_clust.csv')[, 2]

# Target Data
X_target <- read.csv('tests/ressources/W2_7_values.csv')
Lab_target <- read.csv('tests/ressources/W2_7_clust.csv')[, 2]

# The true proportions in the target data set X_source
theta_true <- rep(0,10)
for (k in 1:10) theta_true[k] <- sum(Lab_target == k)/length(Lab_target)

# comparison two methods
CytOpT(X_source, X_target, Lab_source, theta_true=theta_true, method='comparison_opt')

```


