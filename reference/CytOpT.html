<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Function to estimate the type cell proportions in an unclassified cytometry data set denoted X_s by using the classification Lab_source from an other cytometry data set X_s. With this function the computation of the estimate of the class proportions is done with a descent ascent or minmax or two algorithms. — CytOpT • CytOpT</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Function to estimate the type cell proportions in an unclassified cytometry data set denoted X_s by using the classification Lab_source from an other cytometry data set X_s. With this function the computation of the estimate of the class proportions is done with a descent ascent or minmax or two algorithms. — CytOpT"><meta name="description" content="Function to estimate the type cell proportions in an unclassified cytometry data set denoted X_s
by using the classification Lab_source from an other cytometry data set X_s. With this function
the computation of the estimate of the class proportions is done with a descent ascent or minmax
or two algorithms."><meta property="og:description" content="Function to estimate the type cell proportions in an unclassified cytometry data set denoted X_s
by using the classification Lab_source from an other cytometry data set X_s. With this function
the computation of the estimate of the class proportions is done with a descent ascent or minmax
or two algorithms."><meta property="og:image" content="https://sistm.github.io/CytOpT-R/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CytOpT</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/CytOpt_HIPC.html">User guide for executing `CytOpT` on `HIPC` data</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sistm/CytOpT-R/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Function to estimate the type cell proportions in an unclassified cytometry data set denoted X_s by using the classification Lab_source from an other cytometry data set X_s. With this function the computation of the estimate of the class proportions is done with a descent ascent or minmax or two algorithms.</h1>
      <small class="dont-index">Source: <a href="https://github.com/sistm/CytOpT-R/blob/main/R/CytOpT.R" class="external-link"><code>R/CytOpT.R</code></a></small>
      <div class="d-none name"><code>CytOpT.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function to estimate the type cell proportions in an unclassified cytometry data set denoted X_s
by using the classification Lab_source from an other cytometry data set X_s. With this function
the computation of the estimate of the class proportions is done with a descent ascent or minmax
or two algorithms.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">CytOpT</span><span class="op">(</span></span>
<span>  <span class="va">X_s</span>,</span>
<span>  <span class="va">X_t</span>,</span>
<span>  <span class="va">Lab_source</span>,</span>
<span>  Lab_target <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  theta_true <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"minmax"</span>, <span class="st">"desasc"</span>, <span class="st">"both"</span><span class="op">)</span>,</span>
<span>  eps <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  n_iter <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  power <span class="op">=</span> <span class="fl">0.99</span>,</span>
<span>  step_grad <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  step <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  lbd <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  n_out <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>  n_stoc <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  minMaxScaler <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  monitoring <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  thresholding <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x-s">X_s<a class="anchor" aria-label="anchor" href="#arg-x-s"></a></dt>
<dd><p>a cytometry dataframe with only <code>d</code> numerical variables for <code>ns</code> observations.
The columns correspond to the different biological markers measured.
One line corresponds to the cytometry measurements performed on one cell. The classification
of this Cytometry data set must be provided with the Lab_source parameters.</p></dd>


<dt id="arg-x-t">X_t<a class="anchor" aria-label="anchor" href="#arg-x-t"></a></dt>
<dd><p>a cytometry dataframe with only <code>d</code> numerical variables for <code>nt</code> observations.
The columns correspond to the different biological markers measured.
One line corresponds to the cytometry measurements performed on one cell. The CytOpT algorithm
targets the cell type proportion in this Cytometry data set</p></dd>


<dt id="arg-lab-source">Lab_source<a class="anchor" aria-label="anchor" href="#arg-lab-source"></a></dt>
<dd><p>a vector of length <code>ns</code> Classification of the X_s cytometry data set</p></dd>


<dt id="arg-lab-target">Lab_target<a class="anchor" aria-label="anchor" href="#arg-lab-target"></a></dt>
<dd><p>a vector of length <code>nt</code> Classification of the X_s cytometry data set</p></dd>


<dt id="arg-theta-true">theta_true<a class="anchor" aria-label="anchor" href="#arg-theta-true"></a></dt>
<dd><p>If available, gold-standard proportions in the target data
set <code>X_t</code> derived from manual gating. It allows to assess the gap between
the estimate and the gold-standard. Default is <code>NULL</code>, in which case no
assessment is performed.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>a character string indicating which method to use to
compute the cytopt, either <code>'minmax'</code>, <code>'desasc'</code>
or  <code>'both'</code> for comparing both Min-max swapping and descent-ascent procedures.
Default is <code>'minmax'</code>.</p></dd>


<dt id="arg-eps">eps<a class="anchor" aria-label="anchor" href="#arg-eps"></a></dt>
<dd><p>a float value of regularization parameter of the Wasserstein distance. Default is <code>1e-04</code></p></dd>


<dt id="arg-n-iter">n_iter<a class="anchor" aria-label="anchor" href="#arg-n-iter"></a></dt>
<dd><p>an integer Constant that iterate method select. Default is <code>10000</code></p></dd>


<dt id="arg-power">power<a class="anchor" aria-label="anchor" href="#arg-power"></a></dt>
<dd><p>a float constant the step size policy of the gradient ascent method is step/n^power. Default is <code>0.99</code></p></dd>


<dt id="arg-step-grad">step_grad<a class="anchor" aria-label="anchor" href="#arg-step-grad"></a></dt>
<dd><p>an integer number step size of the gradient descent algorithm of the outer loop.
Default is <code>10</code></p></dd>


<dt id="arg-step">step<a class="anchor" aria-label="anchor" href="#arg-step"></a></dt>
<dd><p>an integer constant that multiply the step-size policy. Default is <code>5</code></p></dd>


<dt id="arg-lbd">lbd<a class="anchor" aria-label="anchor" href="#arg-lbd"></a></dt>
<dd><p>a float constant that multiply the step-size policy. Default is <code>1e-04</code></p></dd>


<dt id="arg-n-out">n_out<a class="anchor" aria-label="anchor" href="#arg-n-out"></a></dt>
<dd><p>an integer number of iterations in the outer loop. This loop corresponds to the gradient
descent algorithm to minimize the regularized Wasserstein distance between the source and
target data sets. Default is <code>1000</code></p></dd>


<dt id="arg-n-stoc">n_stoc<a class="anchor" aria-label="anchor" href="#arg-n-stoc"></a></dt>
<dd><p>an integer number of iterations in the inner loop. This loop corresponds to the stochastic
algorithm that approximates a maximizer of the semi dual problem. Default is <code>10</code></p></dd>


<dt id="arg-minmaxscaler">minMaxScaler<a class="anchor" aria-label="anchor" href="#arg-minmaxscaler"></a></dt>
<dd><p>a logical flag indicating to whether to scale observations
between 0 and 1. Default is <code>TRUE</code>.</p></dd>


<dt id="arg-monitoring">monitoring<a class="anchor" aria-label="anchor" href="#arg-monitoring"></a></dt>
<dd><p>a logical flag indicating to possibly monitor the gap between the estimated proportions and the manual
gold-standard. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-thresholding">thresholding<a class="anchor" aria-label="anchor" href="#arg-thresholding"></a></dt>
<dd><p>a logical flag indicating whether to threshold negative
values.  Default is <code>TRUE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a object of class <code>CytOpt</code>, which is a list of two elements:</p><ul><li><p><code>proportions</code> a <code>data.frame</code> with the (optionally true and)
  estimated proportions for each <code>method</code></p></li>
<li><p><code>monitoring</code> a list of estimates over the optimization iterations
  for each <code>method</code> (listed within)</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">CytOpT</span><span class="op">(</span>X_s <span class="op">=</span> <span class="va">HIPC_Stanford_1228_1A</span>, X_t <span class="op">=</span> <span class="va">HIPC_Stanford_1369_1A</span>, </span></span>
<span class="r-in"><span>             Lab_source <span class="op">=</span> <span class="va">HIPC_Stanford_1228_1A_labels</span>,</span></span>
<span class="r-in"><span>             method<span class="op">=</span><span class="st">'minmax'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Boris Hejblum, Paul Freulon, Kalidou Ba.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

